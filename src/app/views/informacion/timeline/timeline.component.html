<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="timeline.component.scss">
</head>
<body>
  
    <h2>Historial Producto </h2>
    <p></p>
    
    <div id="formulario">
        <input class="input"   placeholder="Codigo Pedido"  *ngIf="!loadingData" [(ngModel)]="codigoPick" name="codigoPick" (change)="buscarAlerta(codigoPick)" (change)="buscarCabecera(codigoPick)" (change)="buscarTrackBeetrack(codigoPick)">

    </div>
  

    <section id="timeline"> 
      <div *ngFor="let Cabecera of arrayBuscarCabecera.slice(0 , 1)">
        <h1 class="heading">Historial de pedido: {{Cabecera.Codigo_pedido}}</h1>
      </div>
        <div *ngFor="let Cabecera of arrayBuscarCabecera">  
          <h2>{{Cabecera.Descripcion_producto}}</h2>
        </div>

        <ul *ngFor="let Producto of arrayProductos">
            <li>
                <div class="ads">
                  <span class="circle"  [ngStyle]="{'background-color': getColor(Producto.Color), 'color': getColorLetra(Producto.Color)}"><b>{{Producto.Posicion}}</b></span>
                </div>   
                
                <div class="box">
                    <h3 [ngStyle]="{'background-color': getColor(Producto.Color)}" class="title">
                      <!-- <svg *ngIf="Producto.Icono == 1"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M16 48v416h480V48Zm448 384H48v-96h416Zm0-128H48v-96h416ZM48 176V80h416v96Z"/><path fill="currentColor" d="M80 112h32v32H80zm0 128h32v32H80zm0 128h32v32H80z"/></svg>
                      <svg *ngIf="Producto.Icono == 2"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M16 464h480V56H16ZM48 88h416v344H48Z"/><path fill="currentColor" d="M80 128h32v256H80zm64 0h32v192h-32zm64 0h32v256h-32zm64 0h32v192h-32zm64 0h32v192h-32zm64 0h32v256h-32zM144 352h32v32h-32zm128 0h32v32h-32zm64 0h32v32h-32z"/></svg>
                      <svg *ngIf="Producto.Icono == 3"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M454.423 278.957L328 243.839v-8.185a116 116 0 1 0-104 0V312h-24.418l-18.494-22.6a90.414 90.414 0 0 0-126.43-13.367a20.862 20.862 0 0 0-8.026 33.47L215.084 496H472V302.08a24.067 24.067 0 0 0-17.577-23.123M192 132a84 84 0 1 1 136 65.9V132a52 52 0 0 0-104 0v65.9a83.866 83.866 0 0 1-32-65.9m248 332H229.3L79.141 297.75a58.438 58.438 0 0 1 77.181 11.91l28.1 34.34H256V132a20 20 0 0 1 40 0v136.161l144 40Z"/></svg>
                      <svg *ngIf="Producto.Icono == 4"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M184 80h288v32H184zm0 160h288v32H184zm0 160h288v32H184zm-64-240V40H56v32h32v88zM56 262.111V312h80v-32H91.777L136 257.889V192H56v32h48v14.111zM56 440v32h80V344H56v32h48v16H80v32h24v16z"/></svg>
                      <svg *ngIf="Producto.Icono == 5"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M441.885 141.649A32.028 32.028 0 0 0 415.669 128H336V80a32.036 32.036 0 0 0-32-32H48a32.036 32.036 0 0 0-32 32v328h53.082a67.982 67.982 0 0 0 133.836 0h106.164a67.982 67.982 0 0 0 133.836 0H496V226.522a23.882 23.882 0 0 0-4.338-13.763ZM47.98 80H304v176H48ZM136 432a36 36 0 1 1 36-36a36.04 36.04 0 0 1-36 36m240 0a36 36 0 1 1 36-36a36.04 36.04 0 0 1-36 36m88-56h-23.006a68 68 0 0 0-129.988 0H200.994a68 68 0 0 0-129.988 0H48v-88h416Zm0-120H336v-96h79.669L464 229.044Z"/></svg>
                      <svg *ngIf="Producto.Icono == 7"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M425.706 86.294A240 240 0 0 0 86.294 425.705A240 240 0 0 0 425.706 86.294M256 48a207.1 207.1 0 0 1 135.528 50.345L98.345 391.528A207.1 207.1 0 0 1 48 256c0-114.691 93.309-208 208-208m0 416a207.084 207.084 0 0 1-134.986-49.887l293.1-293.1A207.084 207.084 0 0 1 464 256c0 114.691-93.309 208-208 208"/></svg>
                      <svg *ngIf="Producto.Icono == 6"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M448.205 392.507c30.519-27.2 47.8-63.455 47.8-101.078c0-39.984-18.718-77.378-52.707-105.3C410.218 158.963 366.432 144 320 144s-90.218 14.963-123.293 42.131C162.718 214.051 144 251.445 144 291.429s18.718 77.378 52.707 105.3c33.075 27.168 76.861 42.13 123.293 42.13c6.187 0 12.412-.273 18.585-.816l10.546 9.141A199.849 199.849 0 0 0 480 496h16v-34.057l-4.686-4.685a199.17 199.17 0 0 1-43.109-64.751M370.089 423l-21.161-18.341l-7.056.865A180.275 180.275 0 0 1 320 406.857c-79.4 0-144-51.781-144-115.428S240.6 176 320 176s144 51.781 144 115.429c0 31.71-15.82 61.314-44.546 83.358l-9.215 7.071l4.252 12.035a231.287 231.287 0 0 0 37.882 67.817A167.839 167.839 0 0 1 370.089 423"/><path fill="currentColor" d="M60.185 317.476a220.491 220.491 0 0 0 34.808-63.023l4.22-11.975l-9.207-7.066C62.918 214.626 48 186.728 48 156.857C48 96.833 109.009 48 184 48c55.168 0 102.767 26.43 124.077 64.3c3.957-.192 7.931-.3 11.923-.3q12.027 0 23.834 1.167c-8.235-21.335-22.537-40.811-42.2-56.961C270.072 30.279 228.3 16 184 16S97.928 30.279 66.364 56.206C33.886 82.885 16 118.63 16 156.857c0 35.8 16.352 70.295 45.25 96.243a188.4 188.4 0 0 1-40.563 60.729L16 318.515V352h16a190.643 190.643 0 0 0 85.231-20.125a157.3 157.3 0 0 1-5.071-33.645a158.729 158.729 0 0 1-51.975 19.246"/></svg>
                      <svg *ngIf="Producto.Icono == 8"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M408 406.545V248H288v158.545ZM320 280h56v94.545h-56Z"/><path fill="currentColor" d="M271.078 33.749a34 34 0 0 0-47.066.984L32 226.745V496h112V336h64v160h272V225.958ZM448 464H240V304H112v160H64V240L249.412 57.356V57.3L448 240Z"/></svg> 
                   -->
                      <span class="year"><b>{{Producto.Fecha |date: "dd/MM/yyyy"}}  {{Producto.Hora }}</b></span>
                      
                    </h3>
                        <p>  
                          <svg *ngIf="Producto.Icono == 1"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M16 48v416h480V48Zm448 384H48v-96h416Zm0-128H48v-96h416ZM48 176V80h416v96Z"/><path fill="currentColor" d="M80 112h32v32H80zm0 128h32v32H80zm0 128h32v32H80z"/></svg>
                          <svg *ngIf="Producto.Icono == 2"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M16 464h480V56H16ZM48 88h416v344H48Z"/><path fill="currentColor" d="M80 128h32v256H80zm64 0h32v192h-32zm64 0h32v256h-32zm64 0h32v192h-32zm64 0h32v192h-32zm64 0h32v256h-32zM144 352h32v32h-32zm128 0h32v32h-32zm64 0h32v32h-32z"/></svg>
                          <svg *ngIf="Producto.Icono == 3"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M454.423 278.957L328 243.839v-8.185a116 116 0 1 0-104 0V312h-24.418l-18.494-22.6a90.414 90.414 0 0 0-126.43-13.367a20.862 20.862 0 0 0-8.026 33.47L215.084 496H472V302.08a24.067 24.067 0 0 0-17.577-23.123M192 132a84 84 0 1 1 136 65.9V132a52 52 0 0 0-104 0v65.9a83.866 83.866 0 0 1-32-65.9m248 332H229.3L79.141 297.75a58.438 58.438 0 0 1 77.181 11.91l28.1 34.34H256V132a20 20 0 0 1 40 0v136.161l144 40Z"/></svg>
                          <svg *ngIf="Producto.Icono == 4"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M184 80h288v32H184zm0 160h288v32H184zm0 160h288v32H184zm-64-240V40H56v32h32v88zM56 262.111V312h80v-32H91.777L136 257.889V192H56v32h48v14.111zM56 440v32h80V344H56v32h48v16H80v32h24v16z"/></svg>
                          <svg *ngIf="Producto.Icono == 5"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M441.885 141.649A32.028 32.028 0 0 0 415.669 128H336V80a32.036 32.036 0 0 0-32-32H48a32.036 32.036 0 0 0-32 32v328h53.082a67.982 67.982 0 0 0 133.836 0h106.164a67.982 67.982 0 0 0 133.836 0H496V226.522a23.882 23.882 0 0 0-4.338-13.763ZM47.98 80H304v176H48ZM136 432a36 36 0 1 1 36-36a36.04 36.04 0 0 1-36 36m240 0a36 36 0 1 1 36-36a36.04 36.04 0 0 1-36 36m88-56h-23.006a68 68 0 0 0-129.988 0H200.994a68 68 0 0 0-129.988 0H48v-88h416Zm0-120H336v-96h79.669L464 229.044Z"/></svg>
                          <svg *ngIf="Producto.Icono == 7"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M425.706 86.294A240 240 0 0 0 86.294 425.705A240 240 0 0 0 425.706 86.294M256 48a207.1 207.1 0 0 1 135.528 50.345L98.345 391.528A207.1 207.1 0 0 1 48 256c0-114.691 93.309-208 208-208m0 416a207.084 207.084 0 0 1-134.986-49.887l293.1-293.1A207.084 207.084 0 0 1 464 256c0 114.691-93.309 208-208 208"/></svg>
                          <svg *ngIf="Producto.Icono == 6"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M448.205 392.507c30.519-27.2 47.8-63.455 47.8-101.078c0-39.984-18.718-77.378-52.707-105.3C410.218 158.963 366.432 144 320 144s-90.218 14.963-123.293 42.131C162.718 214.051 144 251.445 144 291.429s18.718 77.378 52.707 105.3c33.075 27.168 76.861 42.13 123.293 42.13c6.187 0 12.412-.273 18.585-.816l10.546 9.141A199.849 199.849 0 0 0 480 496h16v-34.057l-4.686-4.685a199.17 199.17 0 0 1-43.109-64.751M370.089 423l-21.161-18.341l-7.056.865A180.275 180.275 0 0 1 320 406.857c-79.4 0-144-51.781-144-115.428S240.6 176 320 176s144 51.781 144 115.429c0 31.71-15.82 61.314-44.546 83.358l-9.215 7.071l4.252 12.035a231.287 231.287 0 0 0 37.882 67.817A167.839 167.839 0 0 1 370.089 423"/><path fill="currentColor" d="M60.185 317.476a220.491 220.491 0 0 0 34.808-63.023l4.22-11.975l-9.207-7.066C62.918 214.626 48 186.728 48 156.857C48 96.833 109.009 48 184 48c55.168 0 102.767 26.43 124.077 64.3c3.957-.192 7.931-.3 11.923-.3q12.027 0 23.834 1.167c-8.235-21.335-22.537-40.811-42.2-56.961C270.072 30.279 228.3 16 184 16S97.928 30.279 66.364 56.206C33.886 82.885 16 118.63 16 156.857c0 35.8 16.352 70.295 45.25 96.243a188.4 188.4 0 0 1-40.563 60.729L16 318.515V352h16a190.643 190.643 0 0 0 85.231-20.125a157.3 157.3 0 0 1-5.071-33.645a158.729 158.729 0 0 1-51.975 19.246"/></svg>
                          <svg *ngIf="Producto.Icono == 8"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M408 406.545V248H288v158.545ZM320 280h56v94.545h-56Z"/><path fill="currentColor" d="M271.078 33.749a34 34 0 0 0-47.066.984L32 226.745V496h112V336h64v160h272V225.958ZM448 464H240V304H112v160H64V240L249.412 57.356V57.3L448 240Z"/></svg> 
                          <svg *ngIf="Producto.Icono == 9"  class="fa-brands fa-html5" xmlns="http://www.w3.org/2000/svg" width="1.4em" height="1.4em" viewBox="0 0 512 512"><path fill="currentColor" d="M448 80a24.027 24.027 0 0 0 24-24V16h-32v32H264a24.027 24.027 0 0 0-24 24v40h-31.375A88.725 88.725 0 0 0 120 200.625v159.946C120 435.247 180.753 496 255.429 496h1.142C331.247 496 392 435.247 392 360.571V200.625A88.725 88.725 0 0 0 303.375 112H272V80ZM152 200.625A56.689 56.689 0 0 1 208.625 144H240v88h-88Zm208 159.946A103.545 103.545 0 0 1 256.571 464h-1.142A103.545 103.545 0 0 1 152 360.571V264h208ZM303.375 144A56.689 56.689 0 0 1 360 200.625V232h-88v-88Z"/></svg>

                              * {{Producto.Origen}}. || Creado por <span><b>{{Producto.Created_by}}</b></span>
                        </p>
                    <!-- <button> Ver más </button> -->    
                </div>                
            </li>
        </ul>

    </section>

    <br>
    <br>
    <br>
    <br>
    <br>
    <br> 
    <h4 *ngIf="!loadingData"></h4>
            
    <div class="greenTable" *ngIf="buscaAlerta" >
      <table class="greenTable" >
        <thead>
          <tr>
              <th>Fecha/Hora</th>
              <th>Guía</th>
              <th>Comuna</th>
              <th>Dirección</th>
              <th>Fecha Compromiso</th>
              <th>Observación</th>
              <th>Código TY</th>
              <!-- <th *ngIf="rol == '5' || rol == '22'">Creado por</th> -->
          </tr>
        </thead>
        <tbody >
            <c-modal [visible]="visible" (visibleChange)="handleLiveDemoChange($event)">
              <c-modal-header class="modal-header-custom">
                <h5 cModalTitle class="modal-title">Observación </h5>
                <!-- <button  (click)="toggleLiveDemo()"cButtonClose></button> -->
              </c-modal-header>
              <c-modal-body class="modal-body-custom">
                  <p style="font-size:15px;">{{observacionActual}}</p>
              </c-modal-body>
              <c-modal-footer class="modal-footer-custom" >
                <button class="cButtonClose" (click)="toggleLiveDemo()" cButton color="secondary">
                  Cerrar
                </button>
              </c-modal-footer>
            </c-modal>
        <!-- <ng-container *ngFor="let objeto of productosRuta;let i = index"> -->
          <tr *ngFor="let toc of arrayTOCTracking; let i = index">
            <td>{{toc.Fecha_hora}}</td>
            <td>{{guiaActual}}</td>
            <td [ngClass]="regex.test(toc.Comuna) ? 'aterisco': '' ">{{toc.Comuna.replace('*','')}}</td>
            <td [ngClass]="regex.test(toc.Direccion) ? 'aterisco': '' ">{{toc.Direccion.replace('*','')}}</td>
            <td [ngClass]="regex.test(toc.Fecha_compromiso) ? 'aterisco': '' "> {{toc.Fecha_compromiso.replace('*','')}}</td>
            <td>
              <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" (click)="verObservacion(toc.Observacion)"><path fill="currentColor" d="M16 8.286C8.454 8.286 2.5 16 2.5 16s5.954 7.715 13.5 7.715c5.77 0 13.5-7.715 13.5-7.715S21.77 8.286 16 8.286zm0 12.52c-2.65 0-4.807-2.156-4.807-4.806S13.35 11.193 16 11.193S20.807 13.35 20.807 16S18.65 20.807 16 20.807zm0-7.612a2.806 2.806 0 1 0 0 5.611a2.806 2.806 0 0 0 0-5.611z"/></svg>
            </td>
            <td>{{toc.Codigo_TY}}</td>
            <td *ngIf="rol == '5' || rol == '22' || rol == '13'">
            </td>
            <!-- <td *ngIf="rol == '5' || rol == '22' ">{{toc.Creado_por}}</td> -->
          </tr>
        <!-- </ng-container> -->
        </tbody>

        </table>
      </div>
</body>
</html>