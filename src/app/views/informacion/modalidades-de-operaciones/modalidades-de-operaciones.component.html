<!-- <header>
    <h2>Modalidades de Operaciones</h2>

    
</header> -->

<div style="max-width: 1100px; margin: 0 auto 20px auto;">
    <div style="display: flex; align-items: center; gap: 10px;">
      <h2 style="font-size: 22px; font-weight: bold; color: #2d3436; margin: 0; display: flex; align-items: center;">
        <svg xmlns="http://www.w3.org/2000/svg" width="15px" height="20px" viewBox="0 0 384 512">
          <path fill="#000" d="M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48M96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24m0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24m0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24m96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24s-24-10.7-24-24s10.7-24 24-24m128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8z" stroke-width="13" stroke="#000" />
        </svg> &nbsp; Grupo de Operaciones
      </h2>
      <div style="flex-grow: 1; height: 2px; background-color: #4CAF50; margin-left: 15px; border-radius: 2px;"></div>
    </div>
  </div>


<c-modal id="liveCOModal" [visible]="visibleCO" (visibleChange)="handleLiveCOChange($event)" size="lg">
    <c-modal-header>
      <h5 cModalTitle>Centro operación </h5>
      <button (click)="toggleLiveCO()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
        <form cForm [formGroup]="formCO" *ngIf="listaComunasFull.length !== 0" (ngSubmit)="registrarCO()"> 
            <div class="card">
              <p></p>
              <h5>Centro Operación</h5>
              <p></p>
            <c-row>
                <c-col [xs]>
                    <div class="">
                        Nombre
                        <input type="text" placeholder="Nombre" class="form-control" formControlName="Centro" >
                        <!-- <input type="text" placeholder="Codigo" class="form-control" formControlName="Codigo" > -->
                        <span class="error" *ngIf="formCO.get('Centro')?.errors?.['required'] && isErrorView">
                            Falta agregar la razón social
                        </span>
                    </div>
                </c-col>
          
                <c-col [xs]>
                    <div class="noEditar">
                      Descripción
                      <!-- <input type="text" placeholder="Codigo" class="form-control"  readonly [disabled]="true" (change)="codigoExistente()" [value]="codigoFinal"> -->
                      <input type="textarea" placeholder="Descripción" class="form-control"  formControlName="Descripcion" >
                      <span class="error" *ngIf="formCO.get('Descripcion')?.errors?.['required'] && isErrorView">
                          Falta agregar la Descripción
                      </span>
                  </div>
                </c-col>
            </c-row>
            <c-row>
              <c-col [xs]>
                <div class="">
                  Región 
                  <select id="Region"  cSelect class="form-control" formControlName="Region">
                      <option *ngFor="let region of listaRegiones"  [value]="region.Id_region"  >{{region.Nombre_region}}</option>
                  </select>
              </div>
            </c-col>
                <c-col [xs]>
                    <div class="">
                      Seguimiento
                      <select id="Region"  cSelect class="form-control" formControlName="Id_modo_seg"  >
                        <option  [value]="'Seleccione una operación'"  >Seleccione una operación</option>
                        <option *ngFor="let op of modalidadOperacion"  [value]="op.id"  >{{op.nombre}}</option>
                      </select>
                    </div>
                </c-col>
               
              </c-row>
              <p></p>
          </div>
            <p></p>
            <c-row>
                <c-col [xs]>
                    <button class="btn btn-success " type="submit"  >Guardar 
                        <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><style>svg{fill:#000000}</style><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>
                    </button>
                </c-col>
                <c-col [xs]>

                </c-col>
                <c-col [xs]>

                </c-col>
                <c-col [xs]>

                </c-col>
            </c-row>
          </form>

          <p></p>

          <div class="greenTable" style="width: 100%;">
        
            <table id="tablaProductosPicking" style="width: 100%;"  >
            <thead>
                <!-- <th>id</th> -->
                <th>Centro</th>
                <th>Descripción</th>
                <th>Seguimiento</th>
                <th>Region</th>
                <th></th>
            </thead>
            <tbody>
    
            <!-- Filas de la tabla con datos -->
            <tr *ngFor="let co of centroOperacion; let i = index">
                <!-- <td class="id">{{co.Id}}</td> -->
                <td>{{co.Centro}}</td>
                <td>{{co.Descripcion}}</td>
                <td>{{co.Seguimiento_nombre}}</td>
                <td>{{co.Region}}</td>
                <td><svg xmlns="http://www.w3.org/2000/svg" (click)="eliminarCO(co.Id)" width="24" height="24" viewBox="0 0 24 24"><path fill="red" d="M6.187 8h11.625l-.695 11.125A2 2 0 0 1 15.121 21H8.879a2 2 0 0 1-1.996-1.875L6.187 8zM19 5v2H5V5h3V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1h3zm-9 0h4V4h-4v1z"/></svg>
                </td>
    
                <!-- <mat-slide-toggle role="switch" onclick="actualizarEstado()"></mat-slide-toggle> -->
            </tr>
            <tr *ngIf="centroOperacion.length == 0">
              <td colspan="4">
                No hay registros
              </td>
            </tr>
            <!-- Agrega más filas según sea necesario -->
        </tbody>
        </table>
        </div>
    

          
        
    </c-modal-body>
    <c-modal-footer>
      <button (click)="toggleLiveCO()" cButton color="secondary">
        Cerrar
      </button>
    </c-modal-footer>
  </c-modal>


  <div class="modulo">

  
      <br>
      <div class="controls">
        <button class="Agregar" color="primary" (click)="toggleLiveDemo()">+ Agregar</button>

        <button (click)="buscarDatos()" class="btn-buscar" >
          <svg xmlns="http://www.w3.org/2000/svg" width="14px" height="14px" viewBox="0 0 512 512">
                <path fill="#fff" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34M208 336c-70.7 0-128-57.2-128-128c0-70.7 57.2-128 128-128c70.7 0 128 57.2 128 128c0 70.7-57.2 128-128 128" stroke-width="13" stroke="#fff" />
            </svg>
            Buscar
        </button>
        <input type="text" placeholder="Buscar" [(ngModel)]="searchTerm" >
      <button class="excel-btn" (click)="DescargarListaOperaciones()">
        <svg xmlns="http://www.w3.org/2000/svg" width="15px" height="14px" viewBox="0 0 384 512" >
            <path fill="#fff" d="M64 0C28.7 0 0 28.7 0 64v384c0 35.3 28.7 64 64 64h256c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0zm192 0v128h128zM155.7 250.2l36.3 51.9l36.3-51.9c7.6-10.9 22.6-13.5 33.4-5.9s13.5 22.6 5.9 33.4L221.3 344l46.4 66.2c7.6 10.9 5 25.8-5.9 33.4s-25.8 5-33.4-5.9L192 385.8l-36.3 51.9c-7.6 10.9-22.6 13.5-33.4 5.9s-13.5-22.6-5.9-33.4l46.3-66.2l-46.4-66.2c-7.6-10.9-5-25.8 5.9-33.4s25.8-5 33.4 5.9z" stroke-width="13" stroke="#fff" />
        </svg> Descargar Excel
      </button>
     </div> 
     <!-- (click)="descargar_excel_rutas_manuales()" -->
     
      <br>
        
        <!-- Aquí puedes agregar un botón para eliminar -->
    <!-- Tabla para mostrar datos -->
    <div class="greenTable" style="width: 100%;">
        
        <table id="tablaProductosPicking" style="width: 100%;"  >
        <thead>
            <th>N°</th>
            <th (click)="sortTableNombre(sortOrder)" class="sortable">Nombre</th>
            <th>Descripción</th>
            <th>Servicio</th>
            <th (click)="sortTableDetalle(sortOrder)" class="sortable">Detalles</th>
            <th (click)="sortTableCO(sortOrder)" class="sortable">Operación</th>
        </thead>
        <tbody>
 
        <!-- Filas de la tabla con datos -->
        <tr *ngFor="let RazonSocial of tableData; let i = index">
            <td class="id">{{i+1}}</td>
            <td class="sortable" (click)="sortTable(sortOrder)">{{RazonSocial.nombre}}</td>
            <td>{{RazonSocial.description}}</td>
            <!-- <td>{{RazonSocial.mod_operacion}}</td> -->
             <td>
              <select id="ssss" *ngIf="RazonSocial.mod_operacion == ''"  cSelect class="form-control" (change)="actualizarServicio(RazonSocial.id, $event)" >
                <option  [value]="0"  >Sin Servicio</option>
                <option *ngFor="let op of listaModOperacion"  [value]="op.id"  >{{op.nombre}}</option>
              </select>

              <select id="ssss" *ngIf="RazonSocial.mod_operacion !== ''"  cSelect class="form-control" (change)="actualizarServicio(RazonSocial.id, $event)" >
                <option  [value]="RazonSocial.id"  >{{RazonSocial.mod_operacion}}</option>
                <option *ngFor="let op of listaModOperacion"  [value]="op.id"  >{{op.nombre}}</option>
              </select>
             </td>
            <td class="estado">
                <mat-slide-toggle [(ngModel)]="RazonSocial.estado" (change)="toggleEstado(RazonSocial.id)" class="green-slide-toggle" >
                    {{ RazonSocial.estado ? 'Activado' : 'Desactivado' }} 
                </mat-slide-toggle>                  
            </td>
            <td>
              <svg xmlns="http://www.w3.org/2000/svg" (click)="seleccionarOperacion(RazonSocial.id)" width="30px" height="30px" viewBox="0 0 24 24">
                <path fill="#45bf4d" d="M16 20.975v-3h-3v-2h3v-3h2v3h3v2h-3v3zM4 18v-2h7.075q-.075.525-.062 1t.087 1zm0-4v-2h9.65q-.575.4-1.037.9T11.8 14zm0-4V8h15v2zm0-4V4h15v2z" />
              </svg>
               <svg  class="MySvgTable" xmlns="http://www.w3.org/2000/svg" (click)="toggleLiveDemoCV()" (click)="seleccionarIdOpTV(RazonSocial.id)" width="30px" height="30px" viewBox="0 0 640 640"><path d="M352 96C352 78.3 337.7 64 320 64C302.3 64 288 78.3 288 96L288 224L160 224C142.3 224 128 238.3 128 256C128 273.7 142.3 288 160 288L288 288L288 416C288 433.7 302.3 448 320 448C337.7 448 352 433.7 352 416L352 288L480 288C497.7 288 512 273.7 512 256C512 238.3 497.7 224 480 224L352 224L352 96zM128 544C128 561.7 142.3 576 160 576L480 576C497.7 576 512 561.7 512 544C512 526.3 497.7 512 480 512L160 512C142.3 512 128 526.3 128 544z"/></svg>
            </td>

            <!-- <mat-slide-toggle role="switch" onclick="actualizarEstado()"></mat-slide-toggle> -->
        </tr>
        
        <!-- Agrega más filas según sea necesario -->
    </tbody>
    </table>
    </div>

  </div>


<c-modal [visible]="visible" (visibleChange)="handleLiveDemoChange($event)">
    <c-modal-header class="modal-header-custom">
      <h4 cModalTitle class="modal-title"> 
        <svg xmlns="http://www.w3.org/2000/svg" width="25px" height="20px" viewBox="0 0 640 512">
          <path fill="#000" d="M144 160a80 80 0 1 0 0-160a80 80 0 1 0 0 160m368 0a80 80 0 1 0 0-160a80 80 0 1 0 0 160M0 298.7C0 310.4 9.6 320 21.3 320h214c-26.6-23.5-43.3-57.8-43.3-96c0-7.6.7-15 1.9-22.3c-13.6-6.3-28.7-9.7-44.6-9.7h-42.7C47.8 192 0 239.8 0 298.7M320 320c24 0 45.9-8.8 62.7-23.3c2.5-3.7 5.2-7.3 8-10.7c2.7-3.3 5.7-6.1 9-8.3C410 262.3 416 243.9 416 224c0-53-43-96-96-96s-96 43-96 96s43 96 96 96m65.4 60.2c-10.3-5.9-18.1-16.2-20.8-28.2H261.4C187.7 352 128 411.7 128 485.3c0 14.7 11.9 26.7 26.7 26.7h300.6c-2.1-5.2-3.2-10.9-3.2-16.4v-3c-1.3-.7-2.7-1.5-4-2.3l-2.6 1.5c-16.8 9.7-40.5 8-54.7-9.7c-4.5-5.6-8.6-11.5-12.4-17.6l-.1-.2l-.1-.2l-2.4-4.1l-.1-.2l-.1-.2c-3.4-6.2-6.4-12.6-9-19.3c-8.2-21.2 2.2-42.6 19-52.3l2.7-1.5v-4.6l-2.7-1.5zM533.3 192h-42.7c-15.9 0-31 3.5-44.6 9.7c1.3 7.2 1.9 14.7 1.9 22.3c0 17.4-3.5 33.9-9.7 49c2.5.9 4.9 2 7.1 3.3l2.6 1.5c1.3-.8 2.6-1.6 4-2.3v-3c0-19.4 13.3-39.1 35.8-42.6c7.9-1.2 16-1.9 24.2-1.9s16.3.6 24.2 1.9c22.5 3.5 35.8 23.2 35.8 42.6v3c1.3.7 2.7 1.5 4 2.3l2.6-1.5c16.8-9.7 40.5-8 54.7 9.7c2.3 2.8 4.5 5.8 6.6 8.7c-2.1-57.1-49-102.7-106.6-102.7zm91.3 163.9c6.3-3.6 9.5-11.1 6.8-18c-2.1-5.5-4.6-10.8-7.4-15.9l-2.3-4c-3.1-5.1-6.5-9.9-10.2-14.5c-4.6-5.7-12.7-6.7-19-3l-2.9 1.7c-9.2 5.3-20.4 4-29.6-1.3s-16.1-14.5-16.1-25.1v-3.4c0-7.3-4.9-13.8-12.1-14.9c-6.5-1-13.1-1.5-19.9-1.5s-13.4.5-19.9 1.5c-7.2 1.1-12.1 7.6-12.1 14.9v3.4c0 10.6-6.9 19.8-16.1 25.1s-20.4 6.6-29.6 1.3l-2.9-1.7c-6.3-3.6-14.4-2.6-19 3c-3.7 4.6-7.1 9.5-10.2 14.6l-2.3 3.9c-2.8 5.1-5.3 10.4-7.4 15.9c-2.6 6.8.5 14.3 6.8 17.9l2.9 1.7c9.2 5.3 13.7 15.8 13.7 26.4s-4.5 21.1-13.7 26.4l-3 1.7c-6.3 3.6-9.5 11.1-6.8 17.9c2.1 5.5 4.6 10.7 7.4 15.8l2.4 4.1c3 5.1 6.4 9.9 10.1 14.5c4.6 5.7 12.7 6.7 19 3l2.9-1.7c9.2-5.3 20.4-4 29.6 1.3s16.1 14.5 16.1 25.1v3.4c0 7.3 4.9 13.8 12.1 14.9c6.5 1 13.1 1.5 19.9 1.5s13.4-.5 19.9-1.5c7.2-1.1 12.1-7.6 12.1-14.9V492c0-10.6 6.9-19.8 16.1-25.1s20.4-6.6 29.6-1.3l2.9 1.7c6.3 3.6 14.4 2.6 19-3c3.7-4.6 7.1-9.4 10.1-14.5l2.4-4.2c2.8-5.1 5.3-10.3 7.4-15.8c2.6-6.8-.5-14.3-6.8-17.9l-3-1.7c-9.2-5.3-13.7-15.8-13.7-26.4s4.5-21.1 13.7-26.4l3-1.7zM472 384a40 40 0 1 1 80 0a40 40 0 1 1-80 0" stroke-width="13" stroke="#000" />
        </svg>
        Agregar Nuevo Grupo </h4>
      <!-- <button  (click)="toggleLiveDemo()"cButtonClose></button> -->
    </c-modal-header>
    <c-modal-body>
        <form action="">
            <label for="nombre">Nombre Grupo</label>
            <input type="text" class="form-control" id="nombre" name="nombre" required>
        
            <label for="description">Descripción</label>
            <!-- <textarea class="materialize-textarea form-control" rows="10" type="text" id="description" name="description" required></textarea> -->
             <input type="text" class="form-control" id="description" name="description"  required>


            <label for="operacion">Operación</label>
            <select name="" id="operacion">
              <option value="0" selected>Seleccione una operación</option>
              <option *ngFor="let op of listaModOperacion" [value]="op.id">{{op.nombre}}</option>
            </select>
        </form>
    </c-modal-body>
    <c-modal-footer class="modal-footer-custom" >
        <button class="cButtonSave" cButton color="secondary" (click)="submitForm()">
            Guardar
        </button>   
        <button class="cButtonClose" (click)="toggleLiveDemo()" (click)="limpararFormulario()" cButton color="secondary">
            Cerrar
        </button>
    </c-modal-footer>
  </c-modal>

<!-- Modal de Registro de Vehículos -->
<div class="custom-modal" *ngIf="visibleModalidad">
  <div class="custom-modal-content">
    <div class="custom-modal-header">
      <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px"  viewBox="0 0 640 640"><path d="M147 170.7L117.2 256L240.1 256L240.1 160L162.2 160C155.4 160 149.3 164.3 147.1 170.7zM48.6 257.9L86.5 149.6C97.8 117.5 128.1 96 162.1 96L360 96C385.2 96 408.9 107.9 424 128L520.2 256.3C587.1 260.5 640 316.1 640 384L640 400C640 435.3 611.3 464 576 464L559.6 464C555.6 508.9 517.9 544 472 544C426.1 544 388.4 508.9 384.4 464L239.7 464C235.7 508.9 198 544 152.1 544C106.2 544 68.5 508.9 64.5 464L64.1 464C28.8 464 .1 435.3 .1 400L.1 320C.1 289.9 20.8 264.7 48.7 257.9zM440 256L372.8 166.4C369.8 162.4 365 160 360 160L288 160L288 256L440 256zM152 496C174.1 496 192 478.1 192 456C192 433.9 174.1 416 152 416C129.9 416 112 433.9 112 456C112 478.1 129.9 496 152 496zM512 456C512 433.9 494.1 416 472 416C449.9 416 432 433.9 432 456C432 478.1 449.9 496 472 496C494.1 496 512 478.1 512 456z"/></svg>
      &nbsp;<h1>Reclutamiento</h1>&nbsp;<div class="line"></div>
    </div>
    <div class="custom-modal-body">
      <div id="vehicleForm" class="input-row">
        <input type="text" id="vehicleCode" placeholder="Código del vehículo" required>
        <input type="text" id="vehicleDescription" placeholder="Descripción (opcional)">
        <select id="vehicleType" required>
          <option *ngFor="let Tv of tiposVehiculo; let i = index"  [value]="Tv.id" >{{Tv.tipo}}</option>
        </select>
        <button class="add-vehicle-btn" id="addVehicle" type="button" (click)="agregarTipoVehiculo()">
            <svg class="MysVG" xmlns="http://www.w3.org/2000/svg" width="30px" height="30px"  viewBox="0 0 512 512"><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM232 344l0-64-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l64 0 0-64c0-13.3 10.7-24 24-24s24 10.7 24 24l0 64 64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0 0 64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"/></svg>
        </button>
      </div>
      <div class="vehicle-table-container">
        <div *ngIf="!isLoading && DatatiposVehiculo.length === 0" class="no-data">
          No se ha encontrado información registrada.
        </div>
        <div *ngIf="isLoading" class="spinner-container">
          <div class="spinner"></div>
        </div>
        <table class="vehicle-table" *ngIf="!isLoading">
          <thead>
            <tr>
              <th>Código</th>
              <th>Tipo</th>
              <th>Descripción</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let Tv of DatatiposVehiculo; let i = index">
              <td>{{Tv.codigo}}</td>
              <td>{{getTipoVehiculoById(Tv.id_tipo)}}</td>
              <td>{{Tv.descripcion}}</td>
              <td>
                <svg (click)="deleteTipoVehiculo(Tv.id)" class="myDELETESvg" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 448 512"><path d="M136.7 5.9L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-8.7-26.1C306.9-7.2 294.7-16 280.9-16L167.1-16c-13.8 0-26 8.8-30.4 21.9zM416 144L32 144 53.1 467.1C54.7 492.4 75.7 512 101 512L347 512c25.3 0 46.3-19.6 47.9-44.9L416 144z"/></svg>
              </td>
            </tr>
            <!-- Filas dinámicas aquí -->
          </tbody>
        </table>
      </div>
    </div>
    <div class="custom-modal-footer">
      <button class="close-btn" (click)="visibleModalidad = false">Cerrar</button>
    </div>
  </div>
</div>





  <div id="alertaContainer"></div>