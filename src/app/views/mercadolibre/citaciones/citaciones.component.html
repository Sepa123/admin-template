
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<div class="container">
<h4 class="header">Gestión de Citaciones de Vehículos</h4>

</div>
<div >
    
    <p></p>
    
    <div class="nada">

        <c-row >
            <c-col xs="6" sm="3">
          
            <div class="card card-gray">
              <table>
                <tr >
                  <td width="98" height="98" style="padding: 0px;">
                    <div class="icon-background">
                      <!-- <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 640 512">
                        <path fill="#5cb85c" d="M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64s-64 28.7-64 64s28.7 64 64 64m448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64s-64 28.7-64 64s28.7 64 64 64m32 32h-64c-17.6 0-33.5 7.1-45.1 18.6c40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64m-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32S208 82.1 208 144s50.1 112 112 112m76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2m-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4" />
                      </svg> -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50"viewBox="0 0 640 512">
                        <path fill="#6c757d" d="M64 104v88h96V96H72c-4.4 0-8 3.6-8 8m482 88l-80.9-96H384v96zm-226 0V96h-96v96zm272 192h-16c0 53-43 96-96 96s-96-43-96-96H256c0 53-43 96-96 96s-96-43-96-96H48c-26.5 0-48-21.5-48-48V104c0-39.8 32.2-72 72-72h393.1c18.9 0 36.8 8.3 49 22.8L625 186.5c9.7 11.5 15 26.1 15 41.2V336c0 26.5-21.5 48-48 48m-64 0a48 48 0 1 0-96 0a48 48 0 1 0 96 0m-368 48a48 48 0 1 0 0-96a48 48 0 1 0 0 96"/>
                     </svg>
                      
                  </div>
                  </td>
                  <td style="padding: 0px;">
                    <div class="text-content">
                      <h3>Total</h3>
                      <div class="number">{{panelCitacion.Total}}</div>
                  </div>
                  </td>
                </tr>
              </table>
          </div>
          
          
            </c-col>
          
            <c-col xs="6" sm="3">
          
              <div class="card card-green">
                <table>
                  <tr>
                    <td width="98" height="98" style="padding: 0px;">
                      <div class="icon-background">
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 640 512">
                          <path fill="#5cb85c" d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128m89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4m323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104l-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8" />
                        </svg> -->

                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 576 512">
                            <path fill="#5cb85c" d="M0 64C0 28.7 28.7 0 64 0h160v128c0 17.7 14.3 32 32 32h128v38.6c-73.9 20.9-128 88.8-128 169.4c0 59.1 29.1 111.3 73.7 143.3c-3.2.5-6.4.7-9.7.7H64c-35.3 0-64-28.7-64-64zm384 64H256V0zm-96 240a144 144 0 1 1 288 0a144 144 0 1 1-288 0m211.3-43.3c-6.2-6.2-16.4-6.2-22.6 0L416 385.4l-28.7-28.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l40 40c6.2 6.2 16.4 6.2 22.6 0l72-72c6.2-6.2 6.2-16.4 0-22.6" />
                        </svg>
                    </div>
                    </td>
                    <td style="padding: 0px;">
                      <div class="text-content">
                        <h3>Confirmado</h3>
                        <div class="number">{{panelCitacion.Confirmado}}</div>
                    </div>
                    </td>
                  </tr>
                </table>
            </div>
          
            </c-col>
          
            <c-col xs="6" sm="3">
          
              <div class="card card-yellow">
                <table >
                  <tr >
                    <td width="98" height="98" style="padding: 0px;">
                      <div class="icon-background">
                        <!-- <svg xmlns="http://www.w3.org/2000/svg"  width="50" height="50" viewBox="0 0 576 512">
                          <path fill="#ffcc00" d="M0 64C0 28.7 28.7 0 64 0h160v128c0 17.7 14.3 32 32 32h128v38.6c-73.9 20.9-128 88.8-128 169.4c0 59.1 29.1 111.3 73.7 143.3c-3.2.5-6.4.7-9.7.7H64c-35.3 0-64-28.7-64-64zm384 64H256V0zm-96 240a144 144 0 1 1 288 0a144 144 0 1 1-288 0m211.3-43.3c-6.2-6.2-16.4-6.2-22.6 0L416 385.4l-28.7-28.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l40 40c6.2 6.2 16.4 6.2 22.6 0l72-72c6.2-6.2 6.2-16.4 0-22.6" />
                        </svg> -->

                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 576 512">
                            <path fill="#ffcc00" d="M0 64C0 28.7 28.7 0 64 0h160v128c0 17.7 14.3 32 32 32h128v38.6c-73.9 20.9-128 88.8-128 169.4c0 59.1 29.1 111.3 73.7 143.3c-3.2.5-6.4.7-9.7.7H64c-35.3 0-64-28.7-64-64zm384 64H256V0zm48 96a144 144 0 1 1 0 288a144 144 0 1 1 0-288m0 240a24 24 0 1 0 0-48a24 24 0 1 0 0 48m-64-142.4v6.4c0 8.8 7.2 16 16 16s16-7.2 16-16v-6.4c0-5.3 4.3-9.6 9.6-9.6h40.5c7.7 0 13.9 6.2 13.9 13.9c0 5.2-2.9 9.9-7.4 12.3l-32 16.8c-5.3 2.8-8.6 8.2-8.6 14.2V384c0 8.8 7.2 16 16 16s16-7.2 16-16v-5.1l23.5-12.3C486.6 358.7 496 343 496 326c0-25.4-20.6-45.9-45.9-45.9h-40.5c-23 0-41.6 18.6-41.6 41.6z" />
                        </svg>
                    </div>
                    </td>
                    <td style="padding: 0px;">
                      <div class="text-content">
                        <h3>Pendiente</h3>
                        <div class="number">{{panelCitacion.Pendiente}}</div>
                    </div>
                    </td>
                  </tr>
                </table>
            </div>
          
            </c-col>
          
            <c-col xs="6" sm="3">
          
            <div class="card card-red">
              <table class="panel">
                <tr class="panel">
                  <td width="98" height="98" style="padding: 0px;">
                    <div class="icon-background">
                      <!-- <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 576 512">
                        <path fill="#d9534f" d="M0 64C0 28.7 28.7 0 64 0h160v128c0 17.7 14.3 32 32 32h128v38.6c-73.9 20.9-128 88.8-128 169.4c0 59.1 29.1 111.3 73.7 143.3c-3.2.5-6.4.7-9.7.7H64c-35.3 0-64-28.7-64-64zm384 64H256V0zm48 96a144 144 0 1 1 0 288a144 144 0 1 1 0-288m0 240a24 24 0 1 0 0-48a24 24 0 1 0 0 48m0-192c-8.8 0-16 7.2-16 16v80c0 8.8 7.2 16 16 16s16-7.2 16-16v-80c0-8.8-7.2-16-16-16" />
                      </svg> -->
                      <svg xmlns="http://www.w3.org/2000/svg"  width="50" height="50"  viewBox="0 0 576 512">
                        <path fill="#d9534f" d="M0 64C0 28.7 28.7 0 64 0h160v128c0 17.7 14.3 32 32 32h128v38.6c-73.9 20.9-128 88.8-128 169.4c0 59.1 29.1 111.3 73.7 143.3c-3.2.5-6.4.7-9.7.7H64c-35.3 0-64-28.7-64-64zm384 64H256V0zm48 96a144 144 0 1 1 0 288a144 144 0 1 1 0-288m59.3 107.3c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0L432 345.4l-36.7-36.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l36.7 36.7l-36.7 36.7c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0l36.7-36.7l36.7 36.7c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6L454.6 368z" />
                    </svg>
                  </div>
                  </td>
                  <td style="padding: 0px;">
                    <div class="text-content">
                      <h3>No Confirma</h3>
                      <div class="number">{{panelCitacion.No_Confirma}}</div>
                  </div>
                  </td>
                </tr>
              </table>
          </div>
          
            </c-col>
          
            
          </c-row>

    </div>
    <p></p>

    
    


    <!-- Selector de Fecha y Botón Nueva Citación -->
    <div class="input-group">
      <div class="input-container">
          <label for="fechaCitaciones">Seleccionar Fecha:</label>
          <input type="date" class="from-control" id="fechaCitaciones" [min]="minDate" (keydown)="preventTyping($event)"
              [(ngModel)]="minDate" (change)="onDateChange($event)">
      </div>
      <div class="input-container">
          <label for="OperacionInput">Filtrar por Operación/Centro</label>
          <input placeholder="🔍 Operacion" type="text" (input)="buscarOperaciones($event)">
      </div>
  </div>
  <!-- Tabla de Citaciones -->
</div>

<div>
  <div *ngIf="mensaje" [ngClass]="['mensaje-notificacion', mensajeClass]">
      {{ mensaje }}
    </div>
  <table class="tablaPrincipal">
      <thead >
          <th class="Content-Principal">Operación</th>
          <th class="Content-Principal">Centro de operación</th>
          <th class="Content-Principal">Región</th>
          <th class="Content-Principal">Citaciones</th>
          <th class="Content-Principal">Detalle</th>
      </thead>
      <tbody *ngFor="let Ct of OperacionesFiltradas">
          <td class="Content-Principal" >
              <svg (click)="getLocation()" (click)="recuperarId(Ct.Id_operacion, Ct.id_cop)" (click)="toggleLiveDemo()" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"  (click)="getRecuperarPatentesCitaciones(Ct.Id_operacion,Ct.id_cop)" >
                  <path fill="currentColor" d="M7 1h10v2h4v9h-2V5h-2v2H7V5H5v16h7v2H3V3h4zm2 4h6V3H9zm11 9v4h4v2h-4v4h-2v-4h-4v-2h4v-4z" />
              </svg>
              {{Ct.operacion}}
          </td>
          <td class="Content-Principal" id="nombre_CopTd">{{Ct.nombre_cop}}</td>
          <td class="Content-Principal">{{Ct.region_name}}</td>
          <td class="citaciones">
              <div class="citaciones-total">{{Ct.citacion}}</div>
              <div class="citaciones-detalle">
                  <div class="cuadro verde" title="Aprobadas">{{Ct.confirmados}}</div>
                  <div class="cuadro amarillo" title="Pendientes">{{Ct.pendientes}}</div>
                  <div class="cuadro rojo" title="Rechazadas">{{Ct.rechazadas}}</div>
                  <div class="cuadro celeste" title="Ambulancias">{{Ct.ambulancia}}</div>
              </div>
          </td>
          <td class="Content-Principal" >
              <svg  xmlns="http://www.w3.org/2000/svg" width="2.2em" height="2.2em" viewBox="0 0 24 24" (click)="getLocation()" (click)="recuperarId(Ct.Id_operacion, Ct.id_cop)" (click)="toggleLive3()" (click)="recuperarOpCopAMB(Ct.Id_operacion, Ct.id_cop)"(click)="getPatentesFiltradasPorOpyCop(Ct.Id_operacion, Ct.id_cop)" >
                  <path fill="currentColor" d="M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5" />
              </svg>
          </td>
      </tbody>
  </table>
</div>

<c-modal  [visible]="visible" (visibleChange)="handleLiveDemoChange($event)" [backdrop]="'static'">
  <c-modal-header class ="Modal_patentes_ingresadas">
      <h5 class="modal-title" id="modalNuevaCitacionLabel">Selección de Patentes</h5>
      <button (click)="toggleLiveDemo()" type="button" cButtonClose class="close" data-dismiss="modal" aria-label="Close" >
      </button>
      
      <!-- <button  (click)="toggleLiveDemo()"cButtonClose></button> -->
  </c-modal-header>

  <c-modal-body class ="Modal_patentes_ingresadas">
      
      <!-- *ngFor="let pu of patentesList2 -->
      <input class="inputSP" placeholder="🔍 Patente" type="text" (input)="buscarPatente($event)">
      <table  >
          <thead >
              <tr >
                  <th class="thclass" style="background-color: #f2f2f2; color: #333">Patentes</th>
                  <th class="thclass" style="background-color: #f2f2f2;color: #333">Tipo de Vehículo</th>
                  <th class="thclass" style="background-color: #f2f2f2;color: #333">Razón Social</th>
                  <th class="thclass" style="background-color: #f2f2f2;color: #333">Calificación</th>
              </tr>
          </thead>
          <tbody class="modal-body">
              <!-- Ejemplo de fila de datos -->
              <tr *ngIf="patentesFiltradas.length === 0">
                  <td colspan="4" class="thclass">No se han encontrado información de patentes</td>
              </tr>
              <tr *ngFor="let pu of patentesFiltradas">
                  <td class="thclass">
                      <button id="Codigo_patente" class="detalle-patente" (click)="submitForm(pu.id_ppu, pu.ppu)"
                          (click)="recuperarIdPpu(pu.id_ppu)" (click)="getRecargarPatentesCitaciones()" (click)="getLocation()" >
                          {{pu.ppu}}
                      </button>
                  </td>
                  <td class="thclass">

                      <div *ngIf="pu.tipo == null">
                          <span>S/I</span>
                      </div>
                      
                      <div  *ngIf="pu.tipo == 1" class="Icons-vehiculo" >
                          <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 640 512">
                              <path fill="currentColor"
                                  d="M312 32c-13.3 0-24 10.7-24 24s10.7 24 24 24h25.7l34.6 64H222.9l-27.4-38c-4.5-6.3-11.8-10-19.5-10h-56c-13.3 0-24 10.7-24 24s10.7 24 24 24h43.7l22.1 30.7l-26.6 53.1c-10-2.5-20.5-3.8-31.2-3.8C57.3 224 0 281.3 0 352s57.3 128 128 128c65.3 0 119.1-48.9 127-112h49c8.5 0 16.3-4.5 20.7-11.8l84.8-143.5l21.7 40.1C402.4 276.3 384 312 384 352c0 70.7 57.3 128 128 128s128-57.3 128-128s-57.3-128-128-128c-13.5 0-26.5 2.1-38.7 6L375.4 48.8C369.8 38.4 359 32 347.2 32zm146.6 271.7l32.3 59.7c6.3 11.7 20.9 16 32.5 9.7s16-20.9 9.7-32.5l-32.3-59.7c3.6-.6 7.4-.9 11.2-.9c39.8 0 72 32.2 72 72s-32.2 72-72 72s-72-32.2-72-72c0-18.6 7-35.5 18.6-48.3M133.2 368h65c-7.3 32.1-36 56-70.2 56c-39.8 0-72-32.2-72-72s32.2-72 72-72c1.7 0 3.4.1 5.1.2l-24.2 48.5c-9 18.1 4.1 39.4 24.3 39.4zm33.7-48l50.7-101.3l72.9 101.2l-.1.1zm90.6-128H366l-49 82.8l-59.6-82.8z" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 2 " class="Icons-vehiculo">
                          <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                              <path fill="currentColor"
                                  d="M18 18.5a1.5 1.5 0 0 1-1.5-1.5a1.5 1.5 0 0 1 1.5-1.5a1.5 1.5 0 0 1 1.5 1.5a1.5 1.5 0 0 1-1.5 1.5m1.5-9l1.96 2.5H17V9.5m-11 9A1.5 1.5 0 0 1 4.5 17A1.5 1.5 0 0 1 6 15.5A1.5 1.5 0 0 1 7.5 17A1.5 1.5 0 0 1 6 18.5M20 8h-3V4H3c-1.11 0-2 .89-2 2v11h2a3 3 0 0 0 3 3a3 3 0 0 0 3-3h6a3 3 0 0 0 3 3a3 3 0 0 0 3-3h2v-5z" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 3" class="Icons-vehiculo">
                          <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 640 512">
                              <path fill="currentColor"
                                  d="M64 104v88h96V96H72c-4.4 0-8 3.6-8 8m482 88l-80.9-96H384v96zm-226 0V96h-96v96zm272 192h-16c0 53-43 96-96 96s-96-43-96-96H256c0 53-43 96-96 96s-96-43-96-96H48c-26.5 0-48-21.5-48-48V104c0-39.8 32.2-72 72-72h393.1c18.9 0 36.8 8.3 49 22.8L625 186.5c9.7 11.5 15 26.1 15 41.2V336c0 26.5-21.5 48-48 48m-64 0a48 48 0 1 0-96 0a48 48 0 1 0 96 0m-368 48a48 48 0 1 0 0-96a48 48 0 1 0 0 96" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 4" class="Icons-vehiculo">
                          <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 2048 1600">
                              <path fill="currentColor"
                                  d="M480 960q0-66-47-113t-113-47t-113 47t-47 113t47 113t113 47t113-47t47-113m36-320h1016l-89-357q-2-8-14-17.5t-21-9.5H640q-9 0-21 9.5T605 283zm1372 320q0-66-47-113t-113-47t-113 47t-47 113t47 113t113 47t113-47t47-113m160-96v384q0 14-9 23t-23 9h-96v128q0 80-56 136t-136 56t-136-56t-56-136v-128H512v128q0 80-56 136t-136 56t-136-56t-56-136v-128H32q-14 0-23-9t-9-23V864q0-93 65.5-158.5T224 640h28l105-419q23-94 104-157.5T640 0h768q98 0 179 63.5T1691 221l105 419h28q93 0 158.5 65.5T2048 864" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 5" class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 640 512">
                              <path fill="currentColor" d="M640 0v400c0 61.9-50.1 112-112 112c-61 0-110.5-48.7-112-109.3L48.4 502.9c-17.1 4.6-34.6-5.4-39.3-22.5s5.4-34.6 22.5-39.3L352 353.8V64c0-35.3 28.7-64 64-64zm-64 400a48 48 0 1 0-96 0a48 48 0 1 0 96 0M23.1 207.7c-4.6-17.1 5.6-34.6 22.6-39.2l46.4-12.4l20.7 77.3c2.3 8.5 11.1 13.6 19.6 11.3l30.9-8.3c8.5-2.3 13.6-11.1 11.3-19.6l-20.7-77.3l46.4-12.4c17.1-4.6 34.6 5.6 39.2 22.6l41.4 154.5c4.6 17.1-5.6 34.6-22.6 39.2l-154.6 41.5c-17.1 4.6-34.6-5.6-39.2-22.6z" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 6" class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256">
                              <path fill="currentColor" d="M224 96.8V96a56.06 56.06 0 0 0-56-56h-8a16 16 0 0 0-16 16v120h-16V72a8 8 0 0 0-8-8H16A16 16 0 0 0 0 80v104a32 32 0 0 0 56 21.13A32 32 0 0 0 111 192h82a32 32 0 0 0 63-8v-48a40.07 40.07 0 0 0-32-39.2M160 56h8a40 40 0 0 1 40 40v8a8 8 0 0 0 8 8a24 24 0 0 1 24 24v20.31a31.7 31.7 0 0 0-16-4.31a32.06 32.06 0 0 0-31 24h-33Zm-48 24v96h-1a32 32 0 0 0-55-13.13a31.9 31.9 0 0 0-40-6.56V80ZM32 200a16 16 0 1 1 16-16a16 16 0 0 1-16 16m48 0a16 16 0 1 1 16-16a16 16 0 0 1-16 16m144 0a16 16 0 1 1 16-16a16 16 0 0 1-16 16" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 7" class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256">
                              <path fill="currentColor" d="M224 96.8V96a56.06 56.06 0 0 0-56-56h-8a16 16 0 0 0-16 16v120h-16V72a8 8 0 0 0-8-8H16A16 16 0 0 0 0 80v104a32 32 0 0 0 56 21.13A32 32 0 0 0 111 192h82a32 32 0 0 0 63-8v-48a40.07 40.07 0 0 0-32-39.2M32 200a16 16 0 1 1 16-16a16 16 0 0 1-16 16m48 0a16 16 0 1 1 16-16a16 16 0 0 1-16 16m144 0a16 16 0 1 1 16-16a16 16 0 0 1-16 16" />
                          </svg>
                      </div>
                      <div *ngIf="pu.tipo == 8 " class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16">
                              <path fill="currentColor" d="M2 3.75C2 2.784 2.784 2 3.75 2h5.5c.967 0 1.75.784 1.75 1.75V4h.382a1.5 1.5 0 0 1 1.342.83l1.118 2.235a1.5 1.5 0 0 1 .158.671V11a1.5 1.5 0 0 1-1.5 1.5h-.563a2 2 0 0 1-3.874 0H6.937a2 2 0 0 1-3.907-.155A1.75 1.75 0 0 1 2 10.75zm6.063 7.75A2 2 0 0 1 10 10V3.75A.75.75 0 0 0 9.25 3h-5.5a.75.75 0 0 0-.75.75v7c0 .175.06.336.16.464a2 2 0 0 1 3.777.286zM11 10.268a2 2 0 0 1 .937 1.232h.563a.5.5 0 0 0 .5-.5V8h-2zM11 7h1.691l-.862-1.724A.5.5 0 0 0 11.382 5H11zm-6 4a1 1 0 1 0 0 2a1 1 0 0 0 0-2m4 1a1 1 0 1 0 2 0a1 1 0 0 0-2 0" />
                          </svg>
                      </div>
                      
                      <div *ngIf="pu.tipo == 9" class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256">
                              <path fill="currentColor" d="M240 114h-29.51l-43.9-43.9a13.94 13.94 0 0 0-9.9-4.1H44.28a14 14 0 0 0-11.65 6.23L3 116.67A6 6 0 0 0 2 120v48a14 14 0 0 0 14 14h18.6a30 30 0 0 0 58.8 0h69.2a30 30 0 0 0 58.8 0H240a14 14 0 0 0 14-14v-40a14 14 0 0 0-14-14M42.62 78.89a2 2 0 0 1 1.66-.89h112.41a2 2 0 0 1 1.41.59L193.52 114H19.21ZM64 194a18 18 0 1 1 18-18a18 18 0 0 1-18 18m128 0a18 18 0 1 1 18-18a18 18 0 0 1-18 18m50-26a2 2 0 0 1-2 2h-18.6a30 30 0 0 0-58.8 0H93.4a30 30 0 0 0-58.8 0H16a2 2 0 0 1-2-2v-42h226a2 2 0 0 1 2 2Z" />
                          </svg>
                      </div>

                      <div *ngIf="pu.tipo == 10" class="Icons-vehiculo">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 640 512">
                              <path fill="currentColor"
                                  d="M64 104v88h96V96H72c-4.4 0-8 3.6-8 8m482 88l-80.9-96H384v96zm-226 0V96h-96v96zm272 192h-16c0 53-43 96-96 96s-96-43-96-96H256c0 53-43 96-96 96s-96-43-96-96H48c-26.5 0-48-21.5-48-48V104c0-39.8 32.2-72 72-72h393.1c18.9 0 36.8 8.3 49 22.8L625 186.5c9.7 11.5 15 26.1 15 41.2V336c0 26.5-21.5 48-48 48m-64 0a48 48 0 1 0-96 0a48 48 0 1 0 96 0m-368 48a48 48 0 1 0 0-96a48 48 0 1 0 0 96" />
                          </svg>
                      </div>
                      
                  </td>
                  <td class="thclass">{{pu.razon_social}}</td>
                  <td class="thclass">TBA</td>
              </tr>
          </tbody>
      </table>
  </c-modal-body>
  <c-modal-footer class ="Modal_patentes_ingresadas">
      <br>
  </c-modal-footer>
</c-modal>

<c-modal [visible]="visible2" (visibleChange)="handleLiveDemoChange2($event)" [backdrop]="'static'">
  <c-modal-header>
      <div class="HeaderTP" >
        <h2>Agregar Transportista</h2>
        <div class="patenteContainerTp">
          <div class="patenteTP" (click)="copyToClipboard(ppuSeleccionada)" id="patenteTP">{{ppuSeleccionada}}</div>
        </div>
      </div>
      <button (click)="toggleLive3()" (click)="toggleLiveTP()" cButtonClose type="button" class="close" data-dismiss="modal"
          aria-label="Close">
      </button>
      <!-- <button  (click)="toggleLiveDemo()"cButtonClose></button> -->
  </c-modal-header>

  <c-modal-body>
    <div class="modalTP">
      <div class="modal-contentTP">
        <div class="driver-selection">
  
          <div class="select-container">
            <i class="fa-regular fa-id-card DriverPhoto"></i>
            <select class="DriverSelect" id="conductores2" [(ngModel)]="conductores2" (change)="onConductorChange()">
              <option [value]="null" disabled  >Seleccione Conductor</option>
              <ng-container *ngFor="let pu of conductores">
                <option [value]="pu.id">{{pu.nombre_completo}}</option>
              </ng-container>
            </select>
          </div>
          <div class="select-container">
            <i class="fa-solid fa-user DriverPhoto"></i>
            <select class="PeonetaSelect" id="peonetas2" [(ngModel)]="peonetas2" >
              <option value="" disabled >Seleccione Peoneta</option>
              <ng-container *ngFor="let pu of peonetas">
                <option [value]="pu.id">{{pu.nombre_completo}}</option>
              </ng-container>
  
            </select>
          </div>
        </div>
  
        <div class="Iconos-Contacto" *ngIf="conductores2">
          <a [href]="'https://wa.me/' + numeroTelefono" target="_blank">
            <i class="fa-brands fa-whatsapp btn-wsp"></i>
          </a>
          <i class="fa-solid fa-phone btn-phone" (click)="makePhoneCall(numeroTelefono)"></i>
        </div>
        <div class="driver-phone" id="driver-phone" *ngIf="conductores2">
          <i class="fa-solid fa-phone phoneNumber"></i>
          <label class="phoneTP" (click)="copyToClipboard(numeroTelefono)">{{numeroTelefono}}</label>
        </div>
      </div>
    </div>
  </c-modal-body>

  <c-modal-footer>
      <button type="submit" class="btn-guardar"  (click)="ingresoDriversPeonetas()" (click)="toggleLiveTP()" (click)="toggleLive3()">Guardar</button>

  </c-modal-footer>
</c-modal>

<c-modal class="modal-patente-ojo" [visible]="visible3" (visibleChange)="handleLiveDemoChange3($event)" [backdrop]="'static'">
  <c-modal-header>
    <h5 id="modalNuevaCitacionLabel">Patentes</h5>
    <td colspan="2" *ngIf="isLoadingFull">
      <img width="15rem" height="15rem" src="../../../assets/images/loading-gif.gif" />
    </td>
    <button (click)="toggleLive3()" cButtonClose type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
  </c-modal-header>
  <c-modal-body>
    <input class="inputSP" placeholder="🔍 Patente" type="text" (input)="buscarPatenteDetalle($event)">
    <table>
      <thead>
        <tr>
          <th class="thclass">Patente</th>
          <th class="thclass">Estado</th>
          <th class="thclass">ID Meli</th>
          <th class="thclass">Tipo Ruta</th>
          <th class="thclass">Acciones</th>
        </tr>
      </thead>
      <tbody >
        <tr *ngFor="let pu of patentesFiltradasDetalle">
          <td class="tdclass">
            <span id="Codigo_patente" class="detalle-patente">{{pu.ppu}}</span>
          </td>
          <td class="tdclass">
            <select id="estado" name="estado_{{pu.id}}" class="selectEstado" [(ngModel)]="selectedEstados[pu.id]" (change)="updateEstado(pu.id, $event)">
              <option value="" disabled selected>Seleccione una opción</option>
              <option *ngFor="let es of estados" [value]="es.id">{{es.estado}}</option>
            </select>
          </td>
          <td class="tdclass">
            <input type="text" placeholder="Id Meli" #rutaMeliInput id="rutaMeli" class="inputRutaMeli" [(ngModel)]="rutaMeliValues[pu.id]">
          </td>
          <td class="tdclass">
            <select name="selectTipoRuta" id="tipoRuta" [name]="'tipoRuta' + pu.id" class="selectTipoRuta" [(ngModel)]="selectedTipoRuta[pu.id]" (change)="updateTipoRuta(pu.id, $event)">
              <option value="" disabled selected>Seleccione una opción</option>
              <option *ngFor="let tr of dataTipoRuta" [value]="tr.id">{{tr.tipo}}</option>
            </select>
          </td>
          <td>
            <nav class="icons">
              <div [ngStyle]="colorPunto(selectedEstados[pu.id], selectedTipoRuta[pu.id])" class="punto_rojo"></div>
              <ul class="nav-list">
                <li class="nav-item">
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24" (click)="recuperarDatosConductor(pu.id_driver, pu.id_peoneta)" (click)="recuperarIdPpu(pu.id_ppu)" (click)="recuperarPpu(pu.ppu,pu.id_ppu, pu.id)"  (click)="getLocation()"  (click)="toggleLiveTP()" (click)="toggleLive3()">
                    <g fill="none">
                      <circle cx="8" cy="8" r="2.5" stroke="currentColor" stroke-linecap="round" />
                      <path stroke="currentColor" d="M11.768 8.5a2 2 0 1 1 3.464 2a2 2 0 0 1-3.464-2z" />
                      <path fill="currentColor" d="m13.405 17.507l.494-.079zM12.5 18h-9v1h9zm-9.412-.414c.13-.814.442-1.971 1.176-2.915C4.979 13.751 6.119 13 8 13v-1c-2.199 0-3.626.9-4.526 2.057c-.88 1.134-1.231 2.48-1.373 3.371zM8 13c1.881 0 3.02.75 3.736 1.671c.734.944 1.046 2.1 1.176 2.915l.987-.158c-.142-.89-.492-2.237-1.373-3.37C11.626 12.9 10.199 12 8 12zm-4.5 5c-.292 0-.443-.217-.412-.414l-.987-.158C1.958 18.322 2.687 19 3.5 19zm9 1c.813 0 1.542-.678 1.4-1.572l-.988.158c.031.197-.12.414-.412.414z" />
                      <path fill="currentColor" d="m17.297 17.416l-.485.122zM11.8 13.981l-.268-.422l-.515.327l.422.44zm1.605 3.526l.494-.079zm2.99.493H12.5v1h3.895zm.417-.462c.053.215-.104.462-.417.462v1c.87 0 1.62-.772 1.387-1.705zM13.5 14c1.028 0 1.75.503 2.278 1.207c.54.718.856 1.624 1.034 2.33l.97-.242c-.192-.764-.55-1.816-1.204-2.689C15.913 13.72 14.92 13 13.5 13zm-1.432.403c.39-.247.858-.403 1.432-.403v-1c-.768 0-1.421.212-1.968.559zm-.629-.077c.947.99 1.326 2.339 1.473 3.26l.987-.158c-.16-1-.583-2.586-1.737-3.793zm1.473 3.26c.031.197-.12.414-.412.414v1c.813 0 1.542-.678 1.4-1.572z" />
                      <rect width="4.5" height=".5" x="16.25" y="5.25" stroke="currentColor" stroke-linecap="round" stroke-width="0.5" rx=".25" />
                      <rect width="4.5" height=".5" x="18.75" y="3.25" stroke="currentColor" stroke-linecap="round" stroke-width="0.5" rx=".25" transform="rotate(90 18.75 3.25)" />
                    </g>
                  </svg>
                  <span class="tooltip">Usuarios<br>{{ (pu.nombre_driver || pu.nombre_peoneta) ? (pu.nombre_driver + ' ' + pu.nombre_peoneta) : 'S/I de conductores' }}</span>
                </li>
                <li class="nav-item">
                  <svg class="fas fa-save" xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24" (click)="updateRutaMeli(pu.id, rutaMeliInput)" (click)="getLocation()">
                    <path fill="currentColor" d="M21 7v12q0 .825-.587 1.413T19 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12zm-9 11q1.25 0 2.125-.875T15 15t-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18m-6-8h9V6H6z" />
                  </svg>
                  <span class="tooltip">Guardar</span>
                </li>
                <li class="nav-item">
                  <svg class="fas fa-trash" xmlns="http://www.w3.org/2000/svg" style="color: red;" width="1.5em" height="1.5em" viewBox="0 0 512 512" (click)="eliminarPpu(pu.id_ppu)" (click)="getLocation()" (click)="getRecargarPatentesCitaciones()">
                    <rect width="448" height="80" x="32" y="48" fill="currentColor" rx="32" ry="32" />
                    <path fill="currentColor" d="M74.45 160a8 8 0 0 0-8 8.83l26.31 252.56a1.5 1.5 0 0 0 0 .22A48 48 0 0 0 140.45 464h231.09a48 48 0 0 0 47.67-42.39v-.21l26.27-252.57a8 8 0 0 0-8-8.83Zm248.86 180.69a16 16 0 1 1-22.63 22.62L256 318.63l-44.69 44.68a16 16 0 0 1-22.63-22.62L233.37 296l-44.69-44.69a16 16 0 0 1 22.63-22.62L256 273.37l44.68-44.68a16 16 0 0 1 22.63 22.62L278.62 296Z" />
                  </svg>
                  <span class="tooltip">Eliminar</span>
                </li>
                <li class="nav-item" *ngIf="selectedTipoRuta[pu.id] == '5' && selectedEstados[pu.id] == '1'">
                  <svg xmlns="http://www.w3.org/2000/svg" (click)="recuperarIdPpu(pu.id_ppu)" (click)="initializeAmbulanceCode();" (click)="getInfoAMB()" width="1.5em" height="1.5em" viewBox="0 0 24 24" (click)="toggleAmbulance()" (click)="toggleLive3()">
                    <path fill="currentColor" d="M18 18.5a1.5 1.5 0 0 0 1.5-1.5a1.5 1.5 0 0 0-1.5-1.5a1.5 1.5 0 0 0-1.5 1.5a1.5 1.5 0 0 0 1.5 1.5m1.5-9H17V12h4.46zM6 18.5A1.5 1.5 0 0 0 7.5 17A1.5 1.5 0 0 0 6 15.5A1.5 1.5 0 0 0 4.5 17A1.5 1.5 0 0 0 6 18.5M20 8l3 4v5h-2a3 3 0 0 1-3 3a3 3 0 0 1-3-3H9a3 3 0 0 1-3 3a3 3 0 0 1-3-3H1V6c0-1.11.89-2 2-2h14v4zM8 6v3H5v2h3v3h2v-3h3V9h-3V6z" />
                  </svg>
                  <span class="tooltip">Ambulancia</span>
                </li>
              </ul>
            </nav>
          </td>
        </tr>
      </tbody>
    </table>
  </c-modal-body>
  <c-modal-footer>
    <br>
  </c-modal-footer>
</c-modal>

<c-modal [visible]="visibleAmbulance" (visibleChange)="handleLiveDemoChange4($event)" [backdrop]="'static'">
  <c-modal-header class="code-font">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 24 24">
          <path fill="currentColor" 
          d="M18 18.5a1.5 1.5 0 0 0 1.5-1.5a1.5 1.5 0 0 0-1.5-1.5a1.5 1.5 0 0 0-1.5 1.5a1.5 1.5 0 0 0 1.5 1.5m1.5-9H17V12h4.46zM6 18.5A1.5 1.5 0 0 0 7.5 17A1.5 1.5 0 0 0 6 15.5A1.5 1.5 0 0 0 4.5 17A1.5 1.5 0 0 0 6 18.5M20 8l3 4v5h-2a3 3 0 0 1-3 3a3 3 0 0 1-3-3H9a3 3 0 0 1-3 3a3 3 0 0 1-3-3H1V6c0-1.11.89-2 2-2h14v4zM8 6v3H5v2h3v3h2v-3h3V9h-3V6z" />
      </svg>
      <h5 class="modal-title" id="modalNuevaCitacionLabel">Ambulancia</h5>
      <button    cButtonClose type="button" class="close" data-dismiss="modal"
          aria-label="Close" (click)="toggleLive3()" (click)="toggleAmbulance()">
      </button>
      <!-- <button  (click)="toggleLiveDemo()"cButtonClose></button> -->
  </c-modal-header>
  <c-modal-body class="code-font">
      <div class="divider"></div>
      <div class="modal-body2">
        <div class="patente-container">
          <label for="patente">Patente:</label>
          <select id="patente" (change)="onSelectChange($event)">
              <!-- [(ngModel)]="rutaMeliValuesAmb[pu.id_ppu]" -->
            <option value="" disabled selected>Seleccione una opción</option>
    
            <ng-container *ngFor="let ia of infoAmbulancia">
              <option [value]="ia.id_ppu" [attr.data-id-ruta]="ia.ruta_meli" >
                {{ia.ppu}}
              </option>
            </ng-container>
            
          </select>
        </div>
        <div>
          <p id="idRutaMeli">Ruta: 
            <ng-container *ngIf="rutaMeliSeleccionada">
              <span>{{rutaMeliSeleccionada}}</span>
            </ng-container>
          </p>
        </div>
      </div>
    </c-modal-body>
  <c-modal-footer class="code-font">
      <div class="modal-footer">
          <button class="btn btn-save" (click)="getLocation()" (click)="initializeAmbulanceCode()" (click)="ingresarDatosAmbulancia()"  
               >Guardar</button>
  
      </div>
  
  </c-modal-footer>

</c-modal>

<div id="alertaContainer"></div>