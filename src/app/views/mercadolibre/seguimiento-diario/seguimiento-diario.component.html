<div>
    <h2>Datos de Rutas</h2>
    <textarea [(ngModel)]="inputText" id="inputArea" placeholder="Pega aquí los datos desde Excel"></textarea><br>
    <div class="button-container">
      <button class="icon-btn" (click)="procesarDatos()">
        <svg xmlns="http://www.w3.org/2000/svg" width="18.86" height="22" viewBox="0 0 1536 1792">
            <path fill="currentColor" d="M1468 380q28 28 48 76t20 88v1152q0 40-28 68t-68 28H96q-40 0-68-28t-28-68V96q0-40 28-68T96 0h896q40 0 88 20t76 48zm-444-244v376h376q-10-29-22-41l-313-313q-12-12-41-22m384 1528V640H992q-40 0-68-28t-28-68V128H128v1536zm-979-234v106h281v-106h-75l103-161q5-7 10-16.5t7.5-13.5t3.5-4h2q1 4 5 10q2 4 4.5 7.5t6 8t6.5 8.5l107 161h-76v106h291v-106h-68l-192-273l195-282h67V768H828v107h74l-103 159q-4 7-10 16.5t-9 13.5l-2 3h-2q-1-4-5-10q-6-11-17-23L648 875h76V768H434v107h68l189 272l-194 283z" />
        </svg> Procesar
      </button>
      <button class="icon-btn" (click)="guardarDatos()">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 1536 1536">
            <path fill="currentColor" d="M384 1408h768v-384H384zm896 0h128V512q0-14-10-38.5t-20-34.5l-281-281q-10-10-34-20t-39-10v416q0 40-28 68t-68 28H352q-40 0-68-28t-28-68V128H128v1280h128V992q0-40 28-68t68-28h832q40 0 68 28t28 68zM896 480V160q0-13-9.5-22.5T864 128H672q-13 0-22.5 9.5T640 160v320q0 13 9.5 22.5T672 512h192q13 0 22.5-9.5T896 480m640 32v928q0 40-28 68t-68 28H96q-40 0-68-28t-28-68V96q0-40 28-68T96 0h928q40 0 88 20t76 48l280 280q28 28 48 76t20 88" />
        </svg> Guardar
      </button>
    </div>
    <table id="datosTabla">
      <thead>
        <tr>
          <th>#</th>
          <th>Descripción</th>
          <th>ID de ruta</th>
          <th>Fecha inicio</th>
          <th>Fecha fin</th>
          <th>Patente</th>
          <th>Conductor</th>
          <th>Cantidad</th>
          <th>Precio unitario</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of datos; let i = index">
          <td>{{ i + 1 }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'Descripcion')">{{ row.Descripcion }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'IdRuta')">{{ row.IdRuta }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'FechaInicio')">{{ row.FechaInicio }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'FechaFin')">{{ row.FechaFin }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'Patente')">{{ row.Patente }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'Conductor')">{{ row.Conductor }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'Cantidad')">{{ row.Cantidad }}</td>
          <td contenteditable="true" (blur)="updateCell($event, i, 'PrecioUnitario')">{{ row.PrecioUnitario }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  